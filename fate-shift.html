<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>âš¡ Fate Shift</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:radial-gradient(circle at top,#3a005f,#12001f);
  color:#fff;
  text-align:center;
}

/* HEADER */
.header{
  padding:14px;
  font-size:22px;
  font-weight:bold;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.wallet{
  background:rgba(0,0,0,.35);
  padding:6px 14px;
  border-radius:20px;
}

/* CARD */
.card{
  margin:18px;
  padding:20px;
  border-radius:20px;
  background:linear-gradient(180deg,#24003a,#140020);
}

/* MULTI */
.multiplier{
  font-size:46px;
  font-weight:bold;
  margin-bottom:14px;
}

/* BAR */
.bar{
  height:10px;
  background:#333;
  border-radius:10px;
  overflow:hidden;
}
.bar-fill{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#ff5fd8,#ff9f43);
}

/* INPUT */
input{
  width:100%;
  padding:14px;
  border:none;
  border-radius:30px;
  font-size:18px;
  text-align:center;
  margin:14px 0;
}

/* BUTTONS */
.btn{
  width:100%;
  padding:14px;
  border:none;
  border-radius:30px;
  font-size:18px;
  font-weight:bold;
  cursor:pointer;
}
.start{
  background:#ff5fd8;
  color:#000;
}
.start.active{
  box-shadow:0 0 0 3px rgba(255,95,216,.6);
}
.shift{
  background:#6d3b85;
  color:#000;
  opacity:.6;
}
.shift.enabled{
  opacity:1;
}

/* STATUS */
.status{opacity:.85;margin-top:8px}

/* BETS */
.bets-box{
  margin:18px;
  background:#1a0126;
  border-radius:16px;
  padding:14px;
  text-align:left;
}
.bet-row{font-size:14px;padding:6px 0}
.win{color:#4caf50}
.lose{color:#ff5252}
</style>
</head>

<body>

<div class="header">
 âš¡ FATE SHIFT
 <div class="wallet">â‚¹ <span id="wallet">0.00</span></div>
</div>

<div class="card">
  <div class="multiplier"><span id="multi">1.00</span>x</div>

  <div class="bar"><div class="bar-fill" id="bar"></div></div>

  <input id="betInput" type="number" min="10" value="100">

  <button class="btn start" id="startBtn">START CHARGE</button>
  <button class="btn shift" id="shiftBtn" disabled>SHIFT</button>

  <div class="status" id="status">Ready</div>
</div>

<div class="bets-box">
  <h3>MY BETS</h3>
  <div id="bets"></div>
</div>

<script>
/* WALLET (demo â€“ firebase untouched) */
let balance = Number(localStorage.getItem("fs_wallet") || 500);
wallet.innerText = balance.toFixed(2);

/* BET HISTORY PERSIST */
let bets = JSON.parse(localStorage.getItem("fs_bets") || "[]");
renderBets();

/* GAME STATE */
let running=false, timer=null;
let multiplier=1.0;
let barWidth=0;
let bet=0;
let crashPoint=0;

/* START */
startBtn.onclick = ()=>{
  if(running) return;

  bet = Number(betInput.value);
  if(bet < 10 || bet > balance) return alert("Invalid bet");

  startBtn.classList.add("active");
  shiftBtn.disabled = false;
  shiftBtn.classList.add("enabled");

  balance -= bet;
  saveWallet();

  multiplier = 1.0;
  barWidth = 0;
  crashPoint = getCrashPoint();

  running = true;
  status.innerText = "Charging...";
  bar.style.width="0%";
  multi.innerText="1.00";

  timer = setInterval(tick,100);
};

/* MULTIPLIER TICK (FIXED) */
function tick(){
  multiplier += 0.04;
  barWidth += 3;
  bar.style.width = Math.min(barWidth,100)+"%";
  multi.innerText = multiplier.toFixed(2);

  if(multiplier >= crashPoint){
    crash();
  }
}

/* SHIFT */
shiftBtn.onclick = ()=>{
  if(!running) return;
  clearInterval(timer);
  running=false;

  const winAmt = bet * multiplier;
  balance += winAmt;
  addBet(`WIN â‚¹${bet} â†’ â‚¹${winAmt.toFixed(2)}`,"win");
  saveWallet();
  end("ðŸŽ‰ You Win");
};

/* CRASH */
function crash(){
  clearInterval(timer);
  running=false;
  addBet(`LOSS â‚¹${bet}`,"lose");
  end("ðŸ’¥ Crash");
}

/* END */
function end(msg){
  status.innerText = msg;
  startBtn.classList.remove("active");
  shiftBtn.disabled = true;
  shiftBtn.classList.remove("enabled");
}

/* RISK LOGIC (2x ke aas-paas) */
function getCrashPoint(){
  let base = 1.7 + Math.random()*0.7; // 1.7â€“2.4
  let risk = Math.min(bet/1000,1)*0.5;
  return Math.max(1.4, base - risk);
}

/* STORAGE */
function addBet(text,cls){
  bets.unshift({text,cls});
  bets = bets.slice(0,8);
  localStorage.setItem("fs_bets",JSON.stringify(bets));
  renderBets();
}
function renderBets(){
  betsDiv.innerHTML = bets.length
    ? bets.map(b=>`<div class="bet-row ${b.cls}">${b.text}</div>`).join("")
    : "No bets yet";
}
function saveWallet(){
  wallet.innerText = balance.toFixed(2);
  localStorage.setItem("fs_wallet",balance);
}
</script>

</body>
</html>
