<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Aviator</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<style>
body{margin:0;font-family:Arial;background:#0b0b0b;color:#fff}
.header{display:flex;justify-content:space-between;padding:14px;background:#111}
.logo{font-size:26px;font-weight:bold;color:#ff1744}
.balance{font-size:18px;color:#00e676}
.history{display:flex;gap:10px;padding:10px;overflow-x:auto;background:#0f0f0f}
.history span{font-size:14px}
.low{color:#64b5f6}.mid{color:#00e676}.high{color:#e040fb}
.game{height:40vh;display:flex;align-items:center;justify-content:center;background:#000}
.multiplier{font-size:64px;font-weight:bold}
.crashed{color:#ff5252}
.status{text-align:center;padding:8px;color:#aaa}
.controls{padding:12px;display:flex;flex-direction:column;gap:12px}
.betbox{background:#151515;border-radius:14px;padding:12px}
.row{display:flex;gap:8px;margin-bottom:8px}
input{flex:1;padding:10px;border:none;border-radius:8px;font-size:16px;text-align:center}
button{flex:1;padding:10px;border:none;border-radius:8px;font-weight:bold;font-size:16px}
.gray{background:#333;color:#fff}
.green{background:#2ecc71;color:#000}
.locked{opacity:.5;pointer-events:none}
.popup-bg{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center}
.popup{background:#1c1c1c;padding:20px 26px;border-radius:14px;font-size:20px;font-weight:bold}
.win{color:#2ecc71}.loss{color:#ff5252}.betp{color:#64b5f6}
</style>
</head>

<body>

<div class="header">
  <div class="logo">Aviator</div>
  <div class="balance">â‚¹ <span id="wallet">0</span></div>
</div>

<div class="history" id="history"></div>
<div class="game">
  <div class="multiplier" id="multi">WAITING</div>
</div>
<div class="status" id="status"></div>

<div class="controls">
  <div class="betbox" id="box1">
    <div class="row">
      <button class="gray" onclick="chg(1,-1)">-</button>
      <input id="amt1" value="10">
      <button class="gray" onclick="chg(1,1)">+</button>
    </div>
    <div class="row">
      <button class="gray" onclick="setAmt(1,1)">1</button>
      <button class="gray" onclick="setAmt(1,2)">2</button>
      <button class="gray" onclick="setAmt(1,5)">5</button>
      <button class="gray" onclick="setAmt(1,10)">10</button>
    </div>
    <button class="green" id="btn1" onclick="bet(1)">BET</button>
  </div>

  <div class="betbox" id="box2">
    <div class="row">
      <button class="gray" onclick="chg(2,-1)">-</button>
      <input id="amt2" value="1">
      <button class="gray" onclick="chg(2,1)">+</button>
    </div>
    <div class="row">
      <button class="gray" onclick="setAmt(2,1)">1</button>
      <button class="gray" onclick="setAmt(2,2)">2</button>
      <button class="gray" onclick="setAmt(2,5)">5</button>
      <button class="gray" onclick="setAmt(2,10)">10</button>
    </div>
    <button class="green" id="btn2" onclick="bet(2)">BET</button>
  </div>
</div>

<div class="popup-bg" id="popupBg">
  <div class="popup" id="popup"></div>
</div>

<script>
/* ================== STATE ================== */
let S = JSON.parse(localStorage.getItem("AVIATOR_STATE")) || {
  wallet:3000,
  state:"BET",        // BET | LOCK | FLY | CRASH
  timer:25,
  multi:1,
  crash:0,
  active:[false,false],
  betAmt:[0,0],
  history:[]
};

const walletEl=document.getElementById("wallet");
const multiEl=document.getElementById("multi");
const statusEl=document.getElementById("status");
const historyEl=document.getElementById("history");

/* ================== SAVE / LOAD ================== */
function save(){
  localStorage.setItem("AVIATOR_STATE",JSON.stringify(S));
}

/* ================== UI ================== */
function popup(msg,type){
  popupBg.style.display="flex";
  popup.className="popup "+type;
  popup.innerText=msg;
  setTimeout(()=>popupBg.style.display="none",1200);
}

function renderHistory(){
  historyEl.innerHTML="";
  S.history.forEach(x=>{
    let s=document.createElement("span");
    s.textContent=x+"x";
    s.className=x<2?"low":x<10?"mid":"high";
    historyEl.appendChild(s);
  });
}

/* ================== GAME LOGIC ================== */
function randCrash(){
  let r=Math.random();
  if(r<0.6) return +(1+Math.random()*1.5).toFixed(2);
  if(r<0.85) return +(2+Math.random()*3).toFixed(2);
  return +(5+Math.random()*15).toFixed(2);
}

function tick(){
  if(S.state==="BET"){
    statusEl.innerText="Place your bets ("+S.timer+"s)";
    S.timer--;
    if(S.timer<=0){
      S.state="LOCK";
      S.timer=5;
    }
  }
  else if(S.state==="LOCK"){
    statusEl.innerText="Bet locked ("+S.timer+"s)";
    S.timer--;
    if(S.timer<=0){
      startFly();
    }
  }
  else if(S.state==="FLY"){
    S.multi+=0.01+S.multi*0.003;
    S.multi=+S.multi.toFixed(2);
    multiEl.innerText=S.multi+"x";
    statusEl.innerText="Flying...";
    if(S.multi>=S.crash){
      crash();
    }
  }
  save();
}

function startFly(){
  S.state="FLY";
  if(!S.crash) S.crash=randCrash();
  S.multi= S.multi<1 ? 1 : S.multi;
}

function crash(){
  S.state="CRASH";
  multiEl.innerText="CRASHED @ "+S.crash+"x";
  multiEl.classList.add("crashed");
  statusEl.innerText="Crashed";
  S.history.unshift(S.crash);
  S.history=S.history.slice(0,10);
  renderHistory();
  setTimeout(resetRound,2000);
}

function resetRound(){
  S.state="BET";
  S.timer=25;
  S.multi=1;
  S.crash=0;
  S.active=[false,false];
  document.getElementById("btn1").innerText="BET";
  document.getElementById("btn2").innerText="BET";
  multiEl.classList.remove("crashed");
}

/* ================== BET ================== */
function bet(n){
  let i=n-1;
  let amt=+document.getElementById("amt"+n).value;

  if(S.state==="BET"){
    if(S.wallet<amt) return popup("Low Balance","loss");
    S.wallet-=amt;
    S.active[i]=true;
    S.betAmt[i]=amt;
    document.getElementById("btn"+n).innerText="CASH OUT";
    popup("Bet Placed","betp");
  }
  else if(S.state==="FLY" && S.active[i]){
    let win=Math.floor(S.betAmt[i]*S.multi);
    S.wallet+=win;
    S.active[i]=false;
    document.getElementById("btn"+n).innerText="BET";
    popup("Cashed Out @ "+S.multi+"x","win");
  }
  walletEl.innerText=S.wallet;
  save();
}

function chg(n,v){
  let i=document.getElementById("amt"+n);
  i.value=Math.max(1,+i.value+v);
}
function setAmt(n,v){
  document.getElementById("amt"+n).value=v;
}

/* ================== INIT ================== */
walletEl.innerText=S.wallet;
renderHistory();
multiEl.innerText = S.state==="FLY" ? S.multi+"x" : "WAITING";

setInterval(tick,1000);
</script>

</body>
</html>
