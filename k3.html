<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>K3</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:Arial;background:#0f0f0f;color:#fff}
.header{text-align:center;padding:14px;font-size:22px}
.card{background:#1c1c1c;border-radius:14px;padding:15px;margin:12px}
.timer{font-size:36px;color:#ff4081;text-align:center}
.dice{display:flex;justify-content:center;gap:10px;margin:10px}
.dice div{width:55px;height:55px;border-radius:10px;background:#e53935;
display:flex;align-items:center;justify-content:center;font-size:26px}
input{width:100%;padding:12px;border-radius:10px;border:none}
.row{display:flex;gap:10px;margin-top:10px}
.btn{flex:1;padding:12px;border-radius:10px;text-align:center;font-weight:bold}
.big{background:#f4a261}
.small{background:#4dabf7}
.even{background:#4caf50}
.odd{background:#e53935}
.grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:10px}
.num{padding:14px;background:#2a2a2a;border-radius:10px;text-align:center}
.lock{filter:blur(3px);pointer-events:none}
.tabs{display:flex;gap:10px;margin:10px}
.tab{flex:1;padding:12px;background:#ff6f6f;border-radius:10px;text-align:center}
table{width:100%;border-collapse:collapse}
td,th{padding:8px;border-bottom:1px solid #333;text-align:center}
.popup{position:fixed;inset:0;background:rgba(0,0,0,.6);
display:none;align-items:center;justify-content:center}
.pop{background:#222;padding:20px;border-radius:12px;text-align:center}
.pop button{margin-top:10px;padding:8px 20px;border:none;border-radius:8px}
</style>
</head>

<body>

<div class="header">ðŸŽ² K3</div>

<div class="card">
  <div id="info"></div>
  <div class="timer" id="timer">30s</div>
  <div class="dice" id="diceBox">
    <div>?</div><div>?</div><div>?</div>
  </div>
</div>

<div class="card" id="betArea">
  <input id="amount" placeholder="Min â‚¹1">
  <div class="row">
    <div class="btn big" onclick="bet('BIG')">BIG (11-18)</div>
    <div class="btn small" onclick="bet('SMALL')">SMALL (3-10)</div>
  </div>
  <div class="row">
    <div class="btn even" onclick="bet('EVEN')">EVEN</div>
    <div class="btn odd" onclick="bet('ODD')">ODD</div>
  </div>
  <div class="grid" id="nums"></div>
</div>

<div class="tabs">
  <div class="tab" onclick="showHistory()">Game History</div>
  <div class="tab" onclick="showBets()">My Bets</div>
</div>

<div class="card">
  <table id="table"></table>
</div>

<div class="popup" id="popup">
  <div class="pop">
    <div id="popupText"></div>
    <button onclick="popup.style.display='none'">OK</button>
  </div>
</div>

<script>
const ROUND=30;
const BASE=Date.now();
let wallet=Number(localStorage.wallet)||100;
let bets=JSON.parse(localStorage.bets||"[]");
let history=JSON.parse(localStorage.history||"[]");
let currentBets=[];
let dice=[0,0,0],lastRound=-1;

function period(){
 return Math.floor((Date.now()-BASE)/1000/ROUND)+202601200000;
}

function roll(){
 dice=[1+rand(),1+rand(),1+rand()];
 diceBox.innerHTML=dice.map(d=>`<div>${d}</div>`).join("");
}

function rand(){return Math.floor(Math.random()*6)}

function tick(){
 let elapsed=Math.floor((Date.now()-BASE)/1000);
 let remain=ROUND-(elapsed%ROUND);
 timer.innerText=remain+"s";
 info.innerText="Period: "+period()+" | Wallet: â‚¹"+wallet;

 if(remain<=5) betArea.classList.add("lock");
 else betArea.classList.remove("lock");

 let round=Math.floor(elapsed/ROUND);
 if(round!==lastRound && remain===0){
   lastRound=round;
   roll();
   settle();
 }
}

function bet(type){
 let amt=Number(amount.value);
 if(amt<1) return pop("Minimum â‚¹1");
 wallet-=amt;
 localStorage.wallet=wallet;
 currentBets.push({type,amt,period:period()});
 pop("Bet Placed");
}

function settle(){
 let sum=dice.reduce((a,b)=>a+b,0);
 let res=sum>=11?"BIG":"SMALL";
 history.unshift({p:period(),s:sum,r:res});
 history=history.slice(0,10);
 localStorage.history=JSON.stringify(history);

 currentBets.forEach(b=>{
   let win=false;
   if(b.type===res) win=true;
   if(b.type==="EVEN" && sum%2===0) win=true;
   if(b.type==="ODD" && sum%2===1) win=true;
   if(Number(b.type)===sum) win=true;

   let profit=win?b.amt*2:-b.amt;
   if(win) wallet+=b.amt*2;
   bets.unshift({...b,profit});
 });

 currentBets=[];
 localStorage.wallet=wallet;
 localStorage.bets=JSON.stringify(bets);
}

function showHistory(){
 table.innerHTML="<tr><th>Period</th><th>Sum</th><th>Result</th></tr>";
 history.forEach(h=>{
 table.innerHTML+=`<tr><td>${h.p}</td><td>${h.s}</td><td>${h.r}</td></tr>`;
 });
}

function showBets(){
 table.innerHTML="<tr><th>Period</th><th>Bet</th><th>Profit</th></tr>";
 bets.slice(0,10).forEach(b=>{
 table.innerHTML+=`<tr><td>${b.period}</td><td>${b.type}</td><td>${b.profit}</td></tr>`;
 });
}

function pop(t){popupText.innerText=t;popup.style.display="flex"}

nums.innerHTML=[...Array(16)].map((_,i)=>`<div class="num" onclick="bet(${i+3})">${i+3}</div>`).join("");

setInterval(tick,1000);
</script>
</body>
</html>
