<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PLINKO</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:linear-gradient(135deg,#1aa7a1,#0b6f7a);
  color:#fff;
  text-align:center;
}
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 14px;
  font-size:20px;
  font-weight:bold;
}
.wallet{
  background:rgba(0,0,0,.35);
  padding:6px 14px;
  border-radius:20px;
  font-size:14px;
}
.history{
  margin:6px 10px;
  background:rgba(0,0,0,.25);
  padding:8px;
  border-radius:10px;
  font-size:12px;
  overflow-x:auto;
  white-space:nowrap;
}
.board{
  position:relative;
  width:320px;
  height:320px;
  margin:6px auto 0;
}
.pin{
  width:10px;
  height:10px;
  background:#fff;
  border-radius:50%;
  position:absolute;
}
.ball{
  width:14px;
  height:14px;
  background:#fff;
  border-radius:50%;
  position:absolute;
  top:20px;
  left:50%;
  transform:translateX(-50%);
}
.rows{margin:0 10px;}
.row{
  display:grid;
  grid-template-columns:repeat(9,1fr);
  gap:4px;
  margin-bottom:6px;
}
.box{
  padding:6px 0;
  font-size:12px;
  border-radius:6px;
  opacity:.35;
}
.box.active{opacity:1;box-shadow:0 0 6px #fff;}
.red{background:#f44336}
.yellow{background:#ff9800}
.green{background:#4caf50}
.select{
  display:flex;
  justify-content:center;
  gap:10px;
  margin-top:6px;
}
.select button{
  flex:1;
  max-width:110px;
  padding:8px 0;
  border:none;
  border-radius:20px;
  font-weight:bold;
  color:#000;
}
.controls{margin:10px;}
.bet-row{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:10px;
}
.bet{
  background:#000;
  padding:6px 18px;
  border-radius:20px;
}
.ctrl-btn{
  width:36px;
  height:36px;
  border-radius:50%;
  border:none;
  font-size:18px;
}
.drop{
  width:92%;
  padding:14px;
  margin-top:10px;
  border-radius:30px;
  background:#00c853;
  color:#000;
  font-weight:bold;
  font-size:16px;
}
</style>
</head>

<body>

<div class="header">
  <div>PLINKO</div>
  <div class="wallet">â‚¹ <span id="wallet">0</span></div>
</div>

<div class="history" id="history">Encrypted Result:</div>
<div class="board" id="board"></div>

<div class="rows">
  <div class="row">
    <div class="box red">26.3</div><div class="box red">4</div><div class="box red">1.5</div>
    <div class="box red">0.3</div><div class="box red">0.2</div>
    <div class="box red">0.3</div><div class="box red">1.5</div><div class="box red">4</div><div class="box red">26.3</div>
  </div>
  <div class="row">
    <div class="box yellow">10.5</div><div class="box yellow">3</div><div class="box yellow">1.3</div>
    <div class="box yellow">0.7</div><div class="box yellow">0.4</div>
    <div class="box yellow">0.7</div><div class="box yellow">1.3</div><div class="box yellow">3</div><div class="box yellow">10.5</div>
  </div>
  <div class="row">
    <div class="box green">5.4</div><div class="box green">1.8</div><div class="box green">1.1</div>
    <div class="box green">1</div><div class="box green">0.5</div>
    <div class="box green">1</div><div class="box green">1.1</div><div class="box green">1.8</div><div class="box green">5.4</div>
  </div>
</div>

<div class="select">
  <button class="red" id="redBtn">RED</button>
  <button class="yellow" id="yellowBtn">YELLOW</button>
  <button class="green" id="greenBtn">GREEN</button>
</div>

<div class="controls">
  <div class="bet-row">
    <button class="ctrl-btn" id="minus">âˆ’</button>
    <div class="bet">Bet â‚¹ <span id="bet">100</span></div>
    <button class="ctrl-btn" id="plus">+</button>
  </div>
  <button class="drop" id="drop">DROP BALL</button>
</div>

<!-- ðŸ”¥ FIREBASE + GAME (ONE MODULE) -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* FIREBASE CONFIG */
const firebaseConfig = {
  apiKey: "AIzaSyBx3J9aGn_98rTPgurMMKw_GR3puIMj4Ms",
  authDomain: "colourcash-ea60e.firebaseapp.com",
  projectId: "colourcash-ea60e"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* USER */
const userId = "demo_user_001";

/* GAME STATE */
let wallet = 0;
let bet = 100;
let activeColor = "green";

const multipliers = {
  red:[26.3,4,1.5,0.3,0.2,0.3,1.5,4,26.3],
  yellow:[10.5,3,1.3,0.7,0.4,0.7,1.3,3,10.5],
  green:[5.4,1.8,1.1,1,0.5,1,1.1,1.8,5.4]
};

/* LOAD WALLET */
async function loadWallet(){
  const ref = doc(db,"users",userId);
  const snap = await getDoc(ref);
  if(!snap.exists()){
    await setDoc(ref,{ wallet:1000 });
    wallet = 1000;
  }else{
    wallet = snap.data().wallet;
  }
  update();
}

/* SAVE WALLET */
async function saveWallet(){
  await setDoc(doc(db,"users",userId),{ wallet },{ merge:true });
}

/* UI */
function update(){
  document.getElementById("wallet").innerText = wallet;
  document.getElementById("bet").innerText = bet;
}

/* COLOR SELECT */
["red","yellow","green"].forEach(c=>{
  document.getElementById(c+"Btn").onclick=()=>{
    activeColor=c;
    document.querySelectorAll(".box").forEach(b=>b.classList.remove("active"));
    document.querySelectorAll("."+c).forEach(b=>b.classList.add("active"));
  };
});

/* BET */
document.getElementById("plus").onclick=()=>{ if(bet+10<=wallet) bet+=10; update(); };
document.getElementById("minus").onclick=()=>{ if(bet>10) bet-=10; update(); };

/* DROP */
document.getElementById("drop").onclick=()=>{
  if(bet>wallet) return alert("Low balance");
  wallet-=bet;
  const col=Math.floor(Math.random()*9);
  const HOUSE_EDGE=0.40;
  const win=Math.round(bet*multipliers[activeColor][col]*(1-HOUSE_EDGE));
  wallet+=win;
  saveWallet();
  update();
};

loadWallet();
</script>

</body>
</html>
