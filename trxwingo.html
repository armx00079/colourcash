<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>GOD â€¢ DEVIL â€¢ DRAW</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:Arial;background:#0f0f0f;color:#fff}
h1{text-align:center;padding:12px}
.card{background:#1c1c1c;margin:12px;border-radius:14px;padding:16px}
.row{display:flex;gap:10px}
.box{flex:1;text-align:center;padding:20px;border-radius:10px;font-weight:bold;font-size:18px}
.god{background:#2196f3}
.draw{background:#4caf50}
.devil{background:#ff5722}
input,button{width:100%;padding:12px;font-size:16px;border-radius:8px;border:none}
button{background:#2196f3;color:#fff;margin-top:10px}
.locked{background:#555}
.popup{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center}
.popup .inner{background:#222;padding:20px;border-radius:12px;text-align:center}
.small{opacity:.7;font-size:13px}
</style>
</head>

<body>

<h1>ðŸ‘‘ GOD â€¢ DEVIL â€¢ DRAW</h1>

<div class="card">
  <div id="top" class="small"></div>
  <h2 id="phase">BET NOW</h2>
  <h3 id="timer">30s</h3>

  <div class="row">
    <div class="box god" id="godCard">GOD ?</div>
    <div class="box draw">DRAW</div>
    <div class="box devil" id="devilCard">DEVIL ?</div>
  </div>
</div>

<div class="card">
  <input id="amount" type="number" min="1" value="1">
  <div class="row">
    <button onclick="selectBet('GOD')">GOD</button>
    <button onclick="selectBet('DRAW')">DRAW</button>
    <button onclick="selectBet('DEVIL')">DEVIL</button>
  </div>
  <button id="betBtn" onclick="placeBet()">PLACE BET</button>
</div>

<div class="card">
  <h3>Last 10 Games</h3>
  <div id="history"></div>
</div>

<div class="card">
  <h3>My Bets</h3>
  <div id="mybets"></div>
</div>

<div class="popup" id="popup">
  <div class="inner" id="popupText"></div>
</div>

<script>
/* ===== STATE ===== */
let state = JSON.parse(localStorage.getItem("gdd_state")) || {
  period: 1000,
  wallet: 100,
  phase: "BET",
  time: 30,
  bet:null,
  history:[],
  mybets:[]
};

let interval;

/* ===== INIT ===== */
render();
startLoop();

/* ===== LOOP ===== */
function startLoop(){
  clearInterval(interval);
  interval = setInterval(()=>{
    state.time--;
    if(state.phase==="BET" && state.time===5){
      state.phase="LOCK";
    }
    if(state.time<=0){
      if(state.phase!=="RESULT"){
        runResult();
      }
    }
    save();
    render();
  },1000);
}

/* ===== BET ===== */
let selected=null;
function selectBet(t){ selected=t; }

function placeBet(){
  if(state.phase!=="BET"){return;}
  let amt=+amount.value;
  if(!selected||amt<1||amt>state.wallet){return;}
  state.wallet-=amt;
  state.bet={type:selected,amt};
  popup("Bet Placed<br>"+selected+" â‚¹"+amt);
  save();render();
}

/* ===== RESULT ===== */
function runResult(){
  state.phase="RESULT";
  let god=randomCard();
  let devil=randomCard();
  godCard.innerText="GOD "+god;
  devilCard.innerText="DEVIL "+devil;

  let winner="DRAW";
  if(god>devil) winner="GOD";
  if(devil>god) winner="DEVIL";

  let win=false;
  if(state.bet){
    if(state.bet.type===winner){
      let gain = state.bet.amt*2;
      state.wallet+=gain;
      popup("YOU WIN<br>+"+gain);
      win=true;
    }else{
      popup("YOU LOST");
    }
    state.mybets.unshift(`#${state.period} ${state.bet.type} ${win?"WIN":"LOSS"}`);
    state.mybets=state.mybets.slice(0,10);
  }

  state.history.unshift(`#${state.period} â†’ ${winner}`);
  state.history=state.history.slice(0,10);

  setTimeout(nextRound,4000);
}

/* ===== NEXT ROUND ===== */
function nextRound(){
  state.period++;
  state.phase="BET";
  state.time=30;
  state.bet=null;
  godCard.innerText="GOD ?";
  devilCard.innerText="DEVIL ?";
  save();render();
}

/* ===== HELPERS ===== */
function randomCard(){
  return Math.floor(Math.random()*13)+2;
}
function popup(msg){
  popupText.innerHTML=msg;
  popup.style.display="flex";
  setTimeout(()=>popup.style.display="none",2000);
}
function save(){
  localStorage.setItem("gdd_state",JSON.stringify(state));
}
function render(){
  top.innerText=`Period: ${state.period} | Wallet: â‚¹${state.wallet.toFixed(2)}`;
  phase.innerText=state.phase==="LOCK"?"LOCKED":"BET NOW";
  timer.innerText=state.time+"s";
  betBtn.className=state.phase==="LOCK"?"locked":"";
  history.innerHTML=state.history.join("<br>");
  mybets.innerHTML=state.mybets.join("<br>");
}
</script>

</body>
</html>
