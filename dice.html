<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dice Roll Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:radial-gradient(circle at top,#1b1f3b,#0b0f24);
  color:#fff;
  text-align:center;
}

/* WALLET */
#walletBox{
  position:fixed;
  top:12px;
  right:12px;
  background:#000;
  padding:10px 16px;
  border-radius:20px;
  font-weight:bold;
}

/* GAME */
.game-box{
  margin-top:90px;
}

.dice{
  font-size:90px;
  margin:20px 0;
}

input{
  width:140px;
  padding:10px;
  font-size:16px;
  border-radius:10px;
  border:none;
  text-align:center;
}

button{
  margin-top:15px;
  padding:12px 26px;
  font-size:16px;
  border:none;
  border-radius:20px;
  background:linear-gradient(135deg,#ffd56a,#ff9f1a);
  font-weight:bold;
  cursor:pointer;
}

/* POPUP */
.popup{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
}
.popup-box{
  background:#fff;
  color:#000;
  padding:30px 50px;
  border-radius:20px;
  font-size:24px;
  font-weight:bold;
}
</style>
</head>

<body>

<div id="walletBox">ðŸ’° â‚¹<span id="walletAmt">0</span></div>

<div class="game-box">
  <h2>DICE ROLL</h2>
  <div class="dice" id="dice">ðŸŽ²</div>

  <input type="number" id="betAmount" placeholder="Bet Amount"><br>
  <button onclick="rollDice()">ROLL DICE</button>
</div>

<div class="popup" id="popup">
  <div class="popup-box" id="popupText"></div>
</div>

<!-- ================= FIREBASE WALLET CONNECT ================= -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* ðŸ”´ STEP 1: APNA FIREBASE CONFIG YAHA DAAL */
const firebaseConfig = {
  apiKey: "AIzaSyBx3J9aGn_98rTPgurMMKw_GR3puIMj4Ms",
  authDomain: "colourcash-ea60e.firebaseapp.com",
  projectId: "colourcash-ea60e",
  storageBucket: "colourcash-ea60e.firebasestorage.app",
  messagingSenderId: "403688058646",
  appId: "1:403688058646:web:f1753360471528f275ea37"
};

/* INIT */
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* USER DOC */
const userRef = doc(db, "users", "demoUser");

let wallet = 0;
const walletAmt = document.getElementById("walletAmt");
const diceEl = document.getElementById("dice");
const popup = document.getElementById("popup");
const popupText = document.getElementById("popupText");

/* LOAD WALLET */
async function loadWallet(){
  const snap = await getDoc(userRef);
  if(snap.exists()){
    wallet = snap.data().wallet;
    walletAmt.innerText = wallet;
  }
}
loadWallet();

/* ROLL DICE */
window.rollDice = async function(){
  const bet = parseInt(document.getElementById("betAmount").value);
  if(!bet || bet <= 0) return alert("Bet amount daal");
  if(bet > wallet) return alert("Wallet me paisa kam hai");

  // minus bet
  wallet -= bet;
  walletAmt.innerText = wallet;
  await updateDoc(userRef, { wallet });

  // dice roll
  const dice = Math.floor(Math.random()*6) + 1;
  diceEl.innerText = ["","âš€","âš","âš‚","âšƒ","âš„","âš…"][dice];

  let winAmount = 0;

  // rule: 4,5,6 = WIN (2x)
  if(dice >= 4){
    winAmount = bet * 2;
    wallet += winAmount;
    popupText.innerText = "ðŸŽ‰ YOU WIN â‚¹" + winAmount;
  }else{
    popupText.innerText = "âŒ YOU LOSE";
  }

  walletAmt.innerText = wallet;
  await updateDoc(userRef, { wallet });

  popup.style.display = "flex";
  setTimeout(()=>popup.style.display="none",2000);
};
</script>

</body>
</html>
