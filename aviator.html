<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Aviator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  background:#0f0f0f;
  font-family:Arial, sans-serif;
  color:#fff;
  text-align:center;
}
.card{
  background:#1c1c1c;
  border-radius:18px;
  padding:18px;
  margin:15px;
}
.btn{
  width:100%;
  padding:14px;
  border:none;
  border-radius:12px;
  font-size:16px;
  color:#fff;
}
.blue{background:#2196f3}
.pink{background:#e91e63}
.gray{background:#555}
input{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:none;
  font-size:16px;
}
.popup{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  display:none;
  align-items:center;
  justify-content:center;
}
.popup .box{
  background:#222;
  padding:20px;
  border-radius:16px;
  width:80%;
}
</style>
</head>

<body>

<h2>‚úàÔ∏è AVIATOR</h2>

<div class="card">
  <div>
    Period: <b id="period"></b> |
    Wallet: ‚Çπ<b id="wallet"></b>
  </div>

  <h1 id="status" style="color:#00e676">WAIT</h1>
  <h2 id="timer">30s</h2>
  <h1 id="multiplier">1.00x</h1>
</div>

<div class="card">
  <input id="betAmount" placeholder="Min ‚Çπ1" type="number">
  <br><br>
  <button class="btn blue" id="betBtn">PLACE BET</button>
  <br><br>
  <button class="btn pink" id="cashBtn" disabled>CASH OUT</button>
</div>

<div class="card">
  <button class="btn pink" onclick="showHistory()">Game History</button>
  <br><br>
  <button class="btn pink" onclick="showMyBets()">My Bets</button>
</div>

<div class="card">
  <h3>Last 10 Games</h3>
  <div id="history"></div>
</div>

<div class="popup" id="popup">
  <div class="box">
    <h2 id="popupText"></h2>
    <button class="btn pink" onclick="closePopup()">OK</button>
  </div>
</div>

<script>
let wallet = Number(localStorage.wallet || 100);
let period = Number(localStorage.period || Date.now());
let history = JSON.parse(localStorage.history || "[]");
let myBets = JSON.parse(localStorage.myBets || "[]");

let phase = "WAIT";
let timer = 30;
let multiplier = 1;
let crashPoint = 0;
let bet = null;
let loop;

updateUI();
startGame();

function startGame(){
  crashPoint = (Math.random()*3 + 1.2).toFixed(2);
  timer = 30;
  phase = "WAIT";
  multiplier = 1;
  bet = null;
  document.getElementById("cashBtn").disabled = true;
  loop = setInterval(gameLoop,100);
}

function gameLoop(){
  if(phase==="WAIT"){
    timer -= 0.1;
    if(timer<=5){
      phase="LOCK";
      document.getElementById("betBtn").disabled=true;
    }
    if(timer<=0){
      phase="FLY";
      document.getElementById("status").innerText="FLYING";
      document.getElementById("betBtn").disabled=true;
      document.getElementById("cashBtn").disabled = !bet;
    }
  }
  else if(phase==="FLY"){
    multiplier += 0.02;
    if(multiplier>=crashPoint){
      crash();
      return;
    }
  }
  updateUI();
}

function crash(){
  clearInterval(loop);
  phase="CRASH";
  showPopup("üí• CRASH @ "+crashPoint+"x");

  if(bet && !bet.cashout){
    bet.result="LOSS";
    myBets.unshift(bet);
  }

  history.unshift({period,crash:crashPoint});
  history=history.slice(0,10);

  save();
  setTimeout(()=>{
    period++;
    startGame();
  },2000);
}

document.getElementById("betBtn").onclick=()=>{
  let amt=Number(betAmount.value);
  if(amt<1||amt>wallet) return showPopup("Invalid Bet");
  wallet-=amt;
  bet={period,amount:amt,cashout:false};
  showPopup("Bet Placed ‚Çπ"+amt);
  updateUI();
  save();
};

document.getElementById("cashBtn").onclick=()=>{
  if(!bet||bet.cashout) return;
  bet.cashout=true;
  let win=(bet.amount*multiplier).toFixed(2);
  wallet+=Number(win);
  bet.result="WIN @ "+multiplier.toFixed(2)+"x";
  myBets.unshift(bet);
  showPopup("üéâ You Won ‚Çπ"+win);
  updateUI();
  save();
};

function updateUI(){
  periodEl.innerText=period;
  walletEl.innerText=wallet.toFixed(2);
  timerEl.innerText=Math.max(0,Math.floor(timer))+"s";
  multiplierEl.innerText=multiplier.toFixed(2)+"x";
}

function showHistory(){
  historyEl.innerHTML=history.map(h=>`#${h.period} ‚Üí ${h.crash}x`).join("<br>");
}
function showMyBets(){
  historyEl.innerHTML=myBets.map(b=>`#${b.period} ‚Çπ${b.amount} ‚Üí ${b.result}`).join("<br>");
}

function showPopup(t){
  popupText.innerText=t;
  popup.style.display="flex";
}
function closePopup(){popup.style.display="none";}

function save(){
  localStorage.wallet=wallet;
  localStorage.period=period;
  localStorage.history=JSON.stringify(history);
  localStorage.myBets=JSON.stringify(myBets);
}
</script>
</body>
</html>
