<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Aviator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0f0f0f;
  color:#fff;
  text-align:center;
}
.header{
  padding:12px;
  font-size:20px;
  font-weight:bold;
}
.card{
  background:#1c1c1c;
  margin:12px;
  border-radius:14px;
  padding:12px;
}
.multiplier{
  font-size:42px;
  color:#00e676;
  font-weight:bold;
}
.crashed{
  color:#ff5252;
}
button{
  padding:12px;
  border:none;
  border-radius:10px;
  font-size:16px;
  width:100%;
  margin-top:8px;
}
.bet-btn{ background:#ff9800; color:#000; }
.cashout-btn{ background:#00e676; color:#000; }
input{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:none;
  margin-top:8px;
  font-size:16px;
}
.history span{
  display:inline-block;
  background:#333;
  padding:6px 10px;
  border-radius:8px;
  margin:4px;
  font-size:13px;
}
.popup{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  display:none;
  align-items:center;
  justify-content:center;
}
.popup-box{
  background:#1c1c1c;
  padding:20px;
  border-radius:14px;
  width:80%;
}
</style>
</head>

<body>

<div class="header">✈️ AVIATOR</div>

<div class="card">
  Wallet: ₹<span id="wallet">100</span>
</div>

<div class="card">
  <div id="multiplier" class="multiplier">1.00x</div>
  <div id="status">Waiting…</div>
</div>

<div class="card">
  <input type="number" id="betAmount" placeholder="Min ₹1" value="1">
  <button class="bet-btn" id="betBtn">PLACE BET</button>
  <button class="cashout-btn" id="cashoutBtn" style="display:none">CASHOUT</button>
</div>

<div class="card">
  <b>Last Crashes</b>
  <div class="history" id="history"></div>
</div>

<!-- POPUP -->
<div class="popup" id="popup">
  <div class="popup-box">
    <h3 id="popupText"></h3>
    <button onclick="closePopup()">OK</button>
  </div>
</div>

<script>
let wallet = Number(localStorage.getItem("aviator_wallet")) || 100;
let history = JSON.parse(localStorage.getItem("aviator_history")) || [];
let running=false, bet=0, currentX=1, crashX=0;

const walletEl=document.getElementById("wallet");
const multEl=document.getElementById("multiplier");
const histEl=document.getElementById("history");
walletEl.innerText=wallet;

function save(){
  localStorage.setItem("aviator_wallet",wallet);
  localStorage.setItem("aviator_history",JSON.stringify(history));
}

function renderHistory(){
  histEl.innerHTML="";
  history.slice(-10).reverse().forEach(x=>{
    histEl.innerHTML+=`<span>${x}x</span>`;
  });
}
renderHistory();

function startRound(){
  currentX=1;
  crashX=(Math.random()*5+1).toFixed(2); // house edge inside
  running=true;
  document.getElementById("status").innerText="Flying...";
  let interval=setInterval(()=>{
    if(!running){ clearInterval(interval); return; }
    currentX+=0.02;
    multEl.innerText=currentX.toFixed(2)+"x";
    if(currentX>=crashX){
      clearInterval(interval);
      crash();
    }
  },100);
}

function crash(){
  running=false;
  multEl.classList.add("crashed");
  document.getElementById("status").innerText="CRASHED";
  history.push(crashX);
  save();
  renderHistory();
  document.getElementById("cashoutBtn").style.display="none";
  setTimeout(resetRound,2000);
}

function resetRound(){
  multEl.classList.remove("crashed");
  multEl.innerText="1.00x";
  document.getElementById("status").innerText="Waiting…";
}

document.getElementById("betBtn").onclick=()=>{
  bet=Number(betAmount.value);
  if(bet<1){ showPopup("Minimum bet ₹1"); return; }
  if(bet>wallet){ showPopup("Insufficient balance"); return; }
  wallet-=bet;
  walletEl.innerText=wallet;
  save();
  document.getElementById("cashoutBtn").style.display="block";
  startRound();
};

document.getElementById("cashoutBtn").onclick=()=>{
  if(!running) return;
  running=false;
  let win=(bet*currentX*0.9).toFixed(2); // 10% house edge
  wallet+=Number(win);
  walletEl.innerText=wallet;
  save();
  showPopup("You Won ₹"+win);
  history.push(currentX.toFixed(2));
  renderHistory();
  document.getElementById("cashoutBtn").style.display="none";
};

function showPopup(text){
  document.getElementById("popupText").innerText=text;
  document.getElementById("popup").style.display="flex";
}
function closePopup(){
  document.getElementById("popup").style.display="none";
}
</script>

</body>
</html>
