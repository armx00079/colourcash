<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Aviator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0b0b0b;
  color:#fff;
  text-align:center;
}
.header{
  padding:14px;
  font-size:22px;
  font-weight:bold;
}
.plane{
  font-size:60px;
  margin-top:10px;
  transition:transform 0.1s linear;
}
.multiplier{
  font-size:38px;
  margin:10px 0;
  color:#00e676;
}
.timer{
  color:#ff4081;
  font-size:22px;
}
input{
  width:80%;
  padding:12px;
  border-radius:10px;
  border:none;
  margin:10px;
  font-size:18px;
}
button{
  width:80%;
  padding:14px;
  border:none;
  border-radius:12px;
  font-size:18px;
  margin:6px;
}
.bet{background:#2196f3;color:#fff;}
.cashout{background:#ff5252;color:#fff;}
.lock{opacity:0.4;}
.tabs{
  display:flex;
  gap:10px;
  padding:10px;
}
.tabs button{
  width:50%;
  background:#ff6f6f;
}
table{
  width:100%;
  font-size:13px;
}
th,td{
  padding:6px;
  border-bottom:1px solid #333;
}
.hidden{display:none;}
</style>
</head>

<body>

<div class="header">✈️ AVIATOR</div>
<div id="info">Period: <span id="period"></span> | Wallet: ₹<span id="wallet"></span></div>
<div class="timer" id="timer">30s</div>

<div class="plane" id="plane">✈️</div>
<div class="multiplier" id="multi">1.00x</div>

<input id="betAmt" type="number" placeholder="Min ₹1" />
<button class="bet" id="betBtn">PLACE BET</button>
<button class="cashout hidden" id="cashBtn">CASH OUT</button>

<div class="tabs">
  <button onclick="showTab('games')">Game History</button>
  <button onclick="showTab('bets')">My Bets</button>
</div>

<div id="games">
<table>
<thead><tr><th>Period</th><th>Crash</th></tr></thead>
<tbody id="gameHistory"></tbody>
</table>
</div>

<div id="bets" class="hidden">
<table>
<thead><tr><th>Period</th><th>Bet</th><th>X</th><th>P/L</th></tr></thead>
<tbody id="betHistory"></tbody>
</table>
</div>

<script>
let wallet = Number(localStorage.wallet || 100);
let period = Number(localStorage.period || Date.now());
let gameHistory = JSON.parse(localStorage.gameHistory||"[]");
let betHistory = JSON.parse(localStorage.betHistory||"[]");

let time=30, running=false, bet=null, crashX=0, multi=1;
let timerInt, flyInt;

const walletEl=walletSpan=document.getElementById("wallet");
walletEl.innerText=wallet;
document.getElementById("period").innerText=period;

function save(){
 localStorage.wallet=wallet;
 localStorage.period=period;
 localStorage.gameHistory=JSON.stringify(gameHistory);
 localStorage.betHistory=JSON.stringify(betHistory);
}

function startRound(){
 time=30; multi=1; running=false; bet=null;
 document.getElementById("multi").innerText="1.00x";
 document.getElementById("cashBtn").classList.add("hidden");
 document.getElementById("betBtn").classList.remove("hidden","lock");

 crashX=(Math.random()*3+1.2).toFixed(2);
 timerInt=setInterval(()=>{
   time--;
   document.getElementById("timer").innerText=time+"s";

   if(time===5){
     document.getElementById("betBtn").classList.add("lock");
   }

   if(time===0){
     clearInterval(timerInt);
     fly();
   }
 },1000);
}

function fly(){
 running=true;
 document.getElementById("betBtn").classList.add("hidden");
 if(bet) document.getElementById("cashBtn").classList.remove("hidden");

 flyInt=setInterval(()=>{
   multi+=0.01+(multi/50);
   document.getElementById("multi").innerText=multi.toFixed(2)+"x";
   document.getElementById("plane").style.transform=`translate(${multi*8}px,${-multi*4}px)`;

   if(multi>=crashX){
     clearInterval(flyInt);
     crash();
   }
 },60);
}

function crash(){
 running=false;
 gameHistory.unshift({p:period,x:crashX});
 gameHistory=gameHistory.slice(0,10);

 if(bet){
   betHistory.unshift({p:period,b:bet,x:"-",pl:-bet});
   wallet-=bet;
 }
 save(); render();
 period++;
 localStorage.period=period;
 setTimeout(startRound,3000);
}

document.getElementById("betBtn").onclick=()=>{
 let amt=Number(betAmt.value);
 if(amt<1) return alert("Minimum bet ₹1");
 if(time<=5) return alert("Bet closed");
 if(amt>wallet) return alert("Low balance");
 bet=amt;
};

document.getElementById("cashBtn").onclick=()=>{
 if(!running) return;
 clearInterval(flyInt);
 let win=(bet*multi).toFixed(2);
 wallet+=Number(win);
 betHistory.unshift({p:period,b:bet,x:multi.toFixed(2),pl:"+"+win});
 save(); render();
 document.getElementById("cashBtn").classList.add("hidden");
};

function render(){
 walletEl.innerText=wallet;
 gameHistoryEl.innerHTML=gameHistory.map(g=>`<tr><td>${g.p}</td><td>${g.x}x</td></tr>`).join("");
 betHistoryEl.innerHTML=betHistory.map(b=>`<tr><td>${b.p}</td><td>${b.b}</td><td>${b.x}</td><td>${b.pl}</td></tr>`).join("");
}
function showTab(t){
 document.getElementById("games").classList.toggle("hidden",t!=="games");
 document.getElementById("bets").classList.toggle("hidden",t!=="bets");
}
render(); startRound();
</script>
</body>
</html>
