<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Aviator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:Arial;background:#0f0f0f;color:#fff;text-align:center}
.box{background:#1c1c1c;margin:15px;border-radius:16px;padding:15px}
.timer{color:#ff4d6d;font-size:26px;font-weight:bold}
.plane{font-size:60px;margin:15px 0;transition:0.1s linear}
.multiplier{font-size:40px;color:#00ff99;font-weight:bold}
input{width:90%;padding:14px;border-radius:10px;border:none;font-size:18px}
button{width:90%;padding:14px;border:none;border-radius:12px;font-size:18px;margin-top:10px}
.place{background:#2196f3;color:#fff}
.cashout{background:#ff5252;color:#fff}
.btns{display:flex;gap:10px;margin:10px}
.btns button{flex:1;background:#ff7b7b}
table{width:100%;border-collapse:collapse;font-size:14px}
th,td{padding:8px;border-bottom:1px solid #333}
.popup{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center}
.popup .card{background:#1c1c1c;padding:20px;border-radius:14px;width:80%}
</style>
</head>
<body>

<h2>✈️ AVIATOR</h2>

<div class="box">
  <div id="info"></div>
  <div class="timer" id="timer">--</div>
  <div class="plane" id="plane">✈️</div>
  <div class="multiplier" id="multi">1.00x</div>
</div>

<div class="box">
  <input id="betAmount" type="number" min="1" placeholder="Min ₹1">
  <button class="place" id="betBtn">PLACE BET</button>
  <button class="cashout" id="cashBtn" style="display:none">CASH OUT</button>
</div>

<div class="btns">
  <button onclick="showTab('game')">Game History</button>
  <button onclick="showTab('bets')">My Bets</button>
</div>

<div class="box" id="gameTab"></div>
<div class="box" id="betTab" style="display:none"></div>

<div class="popup" id="popup"><div class="card" id="popupText"></div></div>

<script>
const ROUND_TIME = 30;
const LOCK_TIME = 5;

let wallet = +localStorage.wallet || 100;
let period = +localStorage.period || Date.now();
let roundStart = +localStorage.roundStart || Date.now();
let crashPoint = +localStorage.crashPoint || (Math.random()*3+1).toFixed(2);

let gameHistory = JSON.parse(localStorage.gameHistory||'[]');
let myBets = JSON.parse(localStorage.myBets||'[]');

let bet = null, crashed=false, flying=false, multiplier=1;
let flyInt, tickInt;

function save(){
 localStorage.wallet=wallet;
 localStorage.period=period;
 localStorage.roundStart=roundStart;
 localStorage.crashPoint=crashPoint;
 localStorage.gameHistory=JSON.stringify(gameHistory.slice(-10));
 localStorage.myBets=JSON.stringify(myBets.slice(-10));
}

function popup(msg){
 let p=document.getElementById("popup");
 p.style.display="flex";
 document.getElementById("popupText").innerHTML=msg;
 setTimeout(()=>p.style.display="none",1800);
}

function startFly(){
 flying=true;
 flyInt=setInterval(()=>{
   multiplier+=0.02;
   multi.innerText=multiplier.toFixed(2)+"x";
   plane.style.transform=`translate(${multiplier*6}px,-${multiplier*4}px)`;
   if(multiplier>=crashPoint){
     clearInterval(flyInt);
     crashed=true;
     flying=false;
     gameHistory.unshift({period,crash:crashPoint});
     if(bet){
       myBets.unshift({period,amount:bet,win:false});
       popup("❌ Lost ₹"+bet);
     }
     resetRound();
   }
 },100);
}

function resetRound(){
 save(); render();
 setTimeout(()=>{
   period++;
   roundStart=Date.now();
   crashPoint=(Math.random()*3+1).toFixed(2);
   multiplier=1; bet=null; crashed=false;
   cashBtn.style.display="none";
   save();
 },3000);
}

function tick(){
 let passed=Math.floor((Date.now()-roundStart)/1000);
 let left=ROUND_TIME-passed;
 timer.innerText=left+"s";
 info.innerText=`Period: ${period} | Wallet ₹${wallet}`;
 if(left<=LOCK_TIME) betBtn.disabled=true;
 else betBtn.disabled=false;
 if(left<=0 && !flying) startFly();
}

betBtn.onclick=()=>{
 let amt=+betAmount.value;
 if(amt<1||amt>wallet) return popup("Invalid Bet");
 bet=amt; wallet-=amt;
 cashBtn.style.display="block";
 popup("Bet Placed ₹"+amt);
 save();
};

cashBtn.onclick=()=>{
 if(!bet||crashed) return;
 let win=(bet*multiplier).toFixed(2);
 wallet+=+win;
 myBets.unshift({period,amount:win,win:true});
 popup("✅ Win ₹"+win);
 bet=null;
 cashBtn.style.display="none";
 save(); render();
};

function render(){
 gameTab.innerHTML="<b>Last 10 Games</b><table><tr><th>Period</th><th>Crash</th></tr>"+
 gameHistory.map(g=>`<tr><td>${g.period}</td><td>${g.crash}x</td></tr>`).join("")+"</table>";
 betTab.innerHTML="<b>My Bets</b><table><tr><th>Period</th><th>Result</th></tr>"+
 myBets.map(b=>`<tr><td>${b.period}</td><td>${b.win?"+₹"+b.amount:"-₹"+b.amount}</td></tr>`).join("")+"</table>";
}

function showTab(t){
 gameTab.style.display=t=="game"?"block":"none";
 betTab.style.display=t=="bets"?"block":"none";
}

render();
tick();
tickInt=setInterval(tick,1000);
</script>
</body>
</html>
