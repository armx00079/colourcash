<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Aviator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:Arial;background:#0f0f0f;color:#fff;text-align:center}
.box{background:#1c1c1c;margin:15px;border-radius:16px;padding:15px}
h2{margin:10px 0}
.timer{color:#ff4d6d;font-size:26px;font-weight:bold}
.plane{font-size:60px;margin:15px 0;transition:0.2s}
.multiplier{font-size:40px;color:#00ff99;font-weight:bold}
input{width:90%;padding:14px;border-radius:10px;border:none;font-size:18px;margin-top:10px}
button{width:90%;padding:14px;border:none;border-radius:12px;font-size:18px;margin-top:12px;cursor:pointer}
.place{background:#2196f3;color:#fff}
.cashout{background:#ff5252;color:#fff}
.btns{display:flex;gap:10px;margin:15px}
.btns button{flex:1;background:#ff7b7b}
table{width:100%;margin-top:10px;border-collapse:collapse}
th,td{padding:8px;border-bottom:1px solid #333;font-size:14px}
.popup{
 position:fixed;top:0;left:0;width:100%;height:100%;
 background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center
}
.popup .card{
 background:#1c1c1c;padding:20px;border-radius:16px;width:80%
}
.popup.success{color:#00ff99}
.popup.loss{color:#ff4d6d}
</style>
</head>
<body>

<h2>✈️ AVIATOR</h2>

<div class="box">
  <div id="info"></div>
  <div class="timer" id="timer">30s</div>
  <div class="plane" id="plane">✈️</div>
  <div class="multiplier" id="multi">1.00x</div>
</div>

<div class="box">
  <input id="betAmount" type="number" min="1" placeholder="Min ₹1">
  <button class="place" id="betBtn">PLACE BET</button>
  <button class="cashout" id="cashBtn" style="display:none">CASH OUT</button>
</div>

<div class="btns">
  <button onclick="showTab('game')">Game History</button>
  <button onclick="showTab('bets')">My Bets</button>
</div>

<div class="box" id="gameTab"></div>
<div class="box" id="betTab" style="display:none"></div>

<div class="popup" id="popup">
  <div class="card" id="popupText"></div>
</div>

<script>
let wallet = +localStorage.wallet || 100;
let period = +localStorage.period || Date.now();
let gameHistory = JSON.parse(localStorage.gameHistory||'[]');
let myBets = JSON.parse(localStorage.myBets||'[]');

let time = 30, interval, flyInterval;
let multiplier = 1;
let bet = null, crashed = false;

function save(){
 localStorage.wallet=wallet;
 localStorage.period=period;
 localStorage.gameHistory=JSON.stringify(gameHistory.slice(-10));
 localStorage.myBets=JSON.stringify(myBets.slice(-10));
}

function popup(text,type){
 let p=document.getElementById("popup");
 p.style.display="flex";
 p.className="popup "+type;
 document.getElementById("popupText").innerHTML=text;
 setTimeout(()=>p.style.display="none",2000);
}

function startRound(){
 time=30; multiplier=1; crashed=false; bet=null;
 document.getElementById("multi").innerText="1.00x";
 document.getElementById("plane").style.transform="translate(0,0)";
 document.getElementById("cashBtn").style.display="none";
 document.getElementById("betBtn").disabled=false;
 period++;
 save();
 interval=setInterval(()=>{
   time--;
   document.getElementById("timer").innerText=time+"s";
   document.getElementById("info").innerText=`Period: ${period} | Wallet ₹${wallet}`;
   if(time==5) document.getElementById("betBtn").disabled=true;
   if(time==0){ clearInterval(interval); startFly(); }
 },1000);
}

function startFly(){
 let crash = (Math.random()*3+1).toFixed(2);
 flyInterval=setInterval(()=>{
   multiplier+=0.02;
   document.getElementById("multi").innerText=multiplier.toFixed(2)+"x";
   document.getElementById("plane").style.transform=`translate(${multiplier*8}px,-${multiplier*6}px)`;
   if(multiplier>=crash){
     clearInterval(flyInterval);
     crashed=true;
     gameHistory.unshift({period,crash});
     if(bet){
       myBets.unshift({period,amount:bet,win:false});
       popup("❌ You Lost ₹"+bet,"loss");
     }
     save(); render();
     setTimeout(startRound,3000);
   }
 },100);
}

document.getElementById("betBtn").onclick=()=>{
 let amt=+betAmount.value;
 if(amt<1) return popup("Minimum bet ₹1","loss");
 if(amt>wallet) return popup("Insufficient balance","loss");
 bet=amt; wallet-=amt;
 popup("Bet Placed ₹"+amt,"success");
 document.getElementById("cashBtn").style.display="block";
 save();
};

document.getElementById("cashBtn").onclick=()=>{
 if(crashed||!bet) return;
 let win=(bet*multiplier).toFixed(2);
 wallet+=+win;
 myBets.unshift({period,amount:win,win:true});
 popup("✅ Win ₹"+win,"success");
 bet=null;
 document.getElementById("cashBtn").style.display="none";
 save(); render();
};

function render(){
 gameTab.innerHTML="<b>Last Games</b><table><tr><th>Period</th><th>Crash</th></tr>"+
 gameHistory.map(g=>`<tr><td>${g.period}</td><td>${g.crash}x</td></tr>`).join("")+"</table>";
 betTab.innerHTML="<b>My Bets</b><table><tr><th>Period</th><th>Result</th></tr>"+
 myBets.map(b=>`<tr><td>${b.period}</td><td>${b.win?"+₹"+b.amount:"-₹"+b.amount}</td></tr>`).join("")+"</table>";
}

function showTab(t){
 gameTab.style.display=t=="game"?"block":"none";
 betTab.style.display=t=="bets"?"block":"none";
}

render(); startRound();
</script>
</body>
</html>
