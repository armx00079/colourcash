<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Aviator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0f0f0f;
  color:#fff;
  text-align:center;
}
.header{
  padding:14px;
  font-size:22px;
  font-weight:bold;
}
.card{
  background:#1c1c1c;
  margin:15px;
  padding:20px;
  border-radius:16px;
}
input{
  width:100%;
  padding:14px;
  font-size:16px;
  border-radius:12px;
  border:none;
}
button{
  width:100%;
  padding:14px;
  margin-top:10px;
  border:none;
  border-radius:12px;
  font-size:16px;
  font-weight:bold;
}
.bet{background:#2196f3;color:#fff;}
.cash{background:#e91e63;color:#fff;}
.lock{opacity:.4;pointer-events:none;}
.row{
  display:flex;
  gap:10px;
  margin:15px;
}
.small{
  flex:1;
  background:#ff4081;
  color:#fff;
}
.popup{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
}
.popup div{
  background:#222;
  padding:20px;
  border-radius:14px;
}
</style>
</head>

<body>

<div class="header">‚úàÔ∏è AVIATOR</div>

<div class="card">
  <div style="display:flex;justify-content:space-between">
    <div>Period: <span id="period"></span></div>
    <div>Wallet: ‚Çπ<span id="wallet"></span></div>
  </div>

  <h2 id="state" style="color:#00e676">WAIT</h2>
  <h3 id="timer" style="color:#ff4081">30s</h3>
  <h1 id="mult" style="color:#00e676">1.00x</h1>

  <input id="betAmt" placeholder="Min ‚Çπ1">
  <button class="bet" id="betBtn" onclick="placeBet()">PLACE BET</button>
  <button class="cash lock" id="cashBtn" onclick="cashOut()">CASH OUT</button>
</div>

<div class="row">
  <button class="small" onclick="showHistory()">Game History</button>
  <button class="small" onclick="showBets()">My Bets</button>
</div>

<div class="card" id="historyBox">Last 10 Games</div>

<div class="popup" id="popup">
  <div id="popupText"></div>
</div>

<script>
const WAIT=30, LOCK=5;
let d=JSON.parse(localStorage.getItem("aviator"));
if(!d){
 d={wallet:100,period:1000,phase:"WAIT",start:Date.now(),
 mult:1,crash:rand(),active:[],bets:[],history:[]};
 save();
}

const pEl=periodEl=period;
const wEl=walletEl=wallet;
function rand(){return +(Math.random()*3+1.2).toFixed(2);}
function save(){localStorage.setItem("aviator",JSON.stringify(d));}

function popup(t){
 let p=document.getElementById("popup");
 document.getElementById("popupText").innerHTML=t;
 p.style.display="flex";
 setTimeout(()=>p.style.display="none",1500);
}

function ui(){
 period.innerText=d.period;
 wallet.innerText=d.wallet;
}
ui(); loop();

function loop(){
 let e=Math.floor((Date.now()-d.start)/1000);
 if(d.phase==="WAIT"){
  let l=WAIT-e;
  timer.innerText=l+"s";
  state.innerText="WAIT";
  betBtn.disabled=l<=LOCK;
  if(l<=0){
   d.phase="FLY";
   d.start=Date.now();
   popup("‚úàÔ∏è Plane Flying");
  }
 }
 else{
  d.mult+=0.01;
  mult.innerText=d.mult.toFixed(2)+"x";
  state.innerText="FLYING";
  cashBtn.classList.remove("lock");
  if(d.mult>=d.crash){crash();return;}
 }
 save();
 setTimeout(loop,100);
}

function placeBet(){
 let a=+betAmt.value;
 if(a<1)return popup("Min ‚Çπ1");
 if(a>d.wallet)return popup("Low Balance");
 if(d.phase!=="WAIT")return popup("Bet Locked");
 d.wallet-=a;
 d.active.push({p:d.period,a,co:null,w:0});
 popup("Bet Placed ‚Çπ"+a);
 ui();save();
}

function cashOut(){
 if(d.phase!=="FLY")return;
 let b=d.active.find(x=>!x.co);
 if(!b)return;
 b.co=d.mult.toFixed(2);
 b.w=Math.floor(b.a*d.mult);
 d.wallet+=b.w;
 popup("‚úÖ Won ‚Çπ"+b.w+" @ "+b.co+"x");
 ui();save();
}

function crash(){
 popup("üí• Crashed @ "+d.crash+"x");
 d.active.forEach(b=>{
  if(!b.co){b.co="CRASH";b.w=0;}
  d.bets.unshift(b);
 });
 d.bets=d.bets.slice(0,20);
 d.history.unshift({p:d.period,c:d.crash});
 d.history=d.history.slice(0,10);
 setTimeout(next,1500);
}

function next(){
 d.period++;d.phase="WAIT";d.start=Date.now();
 d.mult=1;d.crash=rand();d.active=[];
 cashBtn.classList.add("lock");
 showHistory();save();loop();
}

function showHistory(){
 historyBox.innerHTML="<b>Last 10 Games</b><br>"+
 d.history.map(h=>`#${h.p} ‚Üí ${h.c}x`).join("<br>");
}
function showBets(){
 historyBox.innerHTML="<b>My Bets</b><br>"+
 d.bets.map(b=>`#${b.p} ‚Çπ${b.a} | ${b.co} | ‚Çπ${b.w}`).join("<br>");
}
</script>
</body>
</html>
