<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Aviator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  background:#0f0f0f;
  color:#fff;
  font-family:Arial;
  text-align:center;
}
.header{
  padding:14px;
  font-size:22px;
  font-weight:bold;
}
.timer{color:#ff5252;font-size:22px;margin-bottom:5px;}
.flight{
  position:relative;
  height:160px;
  overflow:hidden;
  border-bottom:1px solid #333;
}
.plane{
  position:absolute;
  left:-50px;
  bottom:20px;
  font-size:46px;
  transition:transform 0.08s linear;
}
.multi{
  font-size:36px;
  color:#00e676;
  margin:8px 0;
  font-weight:bold;
}
input{
  width:80%;
  padding:12px;
  border:none;
  border-radius:8px;
  font-size:16px;
  text-align:center;
}
button{
  width:80%;
  margin-top:10px;
  padding:14px;
  border:none;
  border-radius:10px;
  font-size:18px;
  background:#ff5252;
  color:#fff;
}
.locked{background:#555 !important;}
.section{
  margin:15px;
  background:#1c1c1c;
  border-radius:12px;
  padding:10px;
}
table{
  width:100%;
  font-size:13px;
  border-collapse:collapse;
}
th,td{
  padding:6px;
  border-bottom:1px solid #333;
}
.popup{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.75);
  align-items:center;
  justify-content:center;
}
.popup-box{
  background:#1c1c1c;
  padding:22px;
  border-radius:14px;
  width:80%;
}
.popup-box h2{margin:0;color:#00e676;}
</style>
</head>

<body>

<div class="header">‚úàÔ∏è AVIATOR</div>
<div>Period: <span id="period"></span> | Wallet ‚Çπ<span id="wallet"></span></div>
<div class="timer">‚è± <span id="time">30</span>s</div>

<div class="flight">
  <div class="plane" id="plane">‚úàÔ∏è</div>
</div>

<div class="multi" id="multi">1.00x</div>

<input id="bet" type="number" placeholder="Min ‚Çπ1">
<button id="cashBtn" onclick="cashOut()">CASH OUT</button>

<div class="section">
<b>Last 10 Games</b>
<table id="gameHistory"></table>
</div>

<div class="section">
<b>My Bets</b>
<table id="betHistory"></table>
</div>

<!-- POPUP -->
<div class="popup" id="popup">
  <div class="popup-box">
    <h2 id="pTitle"></h2>
    <p id="pText"></p>
    <button onclick="closePopup()">OK</button>
  </div>
</div>

<script>
/* ---------- STORAGE ---------- */
let wallet = Number(localStorage.wallet || 100);
let period = Number(localStorage.period || Date.now());
let gameHistory = JSON.parse(localStorage.gameHistory || "[]");
let betHistory = JSON.parse(localStorage.betHistory || "[]");

/* ---------- STATE ---------- */
let multiplier=1, running=false, crashX=0;
let x=0,y=0,time=30, betLocked=false, timerInt, flyInt;

/* ---------- INIT ---------- */
document.getElementById("wallet").innerText=wallet;
document.getElementById("period").innerText=period;
renderTables();
startRound();

/* ---------- ROUND ---------- */
function startRound(){
  multiplier=1; x=0; y=0; time=30; betLocked=false;
  crashX=(Math.random()*4+1.2).toFixed(2);
  document.getElementById("multi").innerText="1.00x";
  document.getElementById("cashBtn").classList.remove("locked");
  document.getElementById("plane").style.opacity="1";

  running=true;
  flyInt=setInterval(fly,80);
  timerInt=setInterval(tick,1000);
}

function fly(){
  multiplier+=0.03;
  x+=2+multiplier*1.2;
  y+=0.6+multiplier*0.4;
  plane.style.transform=`translate(${x}px,-${y}px)`;
  multi.innerText=multiplier.toFixed(2)+"x";
  if(multiplier>=crashX) crash();
}

function tick(){
  time--;
  document.getElementById("time").innerText=time;
  if(time<=5){
    betLocked=true;
    cashBtn.classList.add("locked");
  }
}

function crash(){
  clearInterval(flyInt);
  clearInterval(timerInt);
  running=false;
  plane.style.opacity="0.3";

  gameHistory.unshift({p:period,x:crashX});
  gameHistory=gameHistory.slice(0,10);
  localStorage.gameHistory=JSON.stringify(gameHistory);

  showPopup("üí• CRASH","Crashed at "+crashX+"x");

  nextRound();
}

function cashOut(){
  if(!running || betLocked) return;
  let bet=Number(bet.value);
  if(bet<1){showPopup("‚ùå Error","Minimum bet ‚Çπ1");return;}
  let win=(bet*multiplier).toFixed(2);
  wallet+=Number(win);
  betHistory.unshift({p:period,res:"WIN",amt:"+"+win});
  save();
  showPopup("üéâ WIN","You won ‚Çπ"+win);
  endRound();
}

function endRound(){
  clearInterval(flyInt);
  clearInterval(timerInt);
  running=false;
  nextRound();
}

function nextRound(){
  period++;
  localStorage.period=period;
  localStorage.wallet=wallet;
  setTimeout(startRound,3000);
}

/* ---------- UI ---------- */
function renderTables(){
  gameHistory.innerHTML="<tr><th>Period</th><th>X</th></tr>"+
    gameHistory.map(g=>`<tr><td>${g.p}</td><td>${g.x}x</td></tr>`).join("");
  betHistory.innerHTML="<tr><th>Period</th><th>Result</th><th>Amt</th></tr>"+
    betHistory.map(b=>`<tr><td>${b.p}</td><td>${b.res}</td><td>${b.amt}</td></tr>`).join("");
}
function save(){
  localStorage.wallet=wallet;
  localStorage.betHistory=JSON.stringify(betHistory);
  renderTables();
  document.getElementById("wallet").innerText=wallet;
}

/* ---------- POPUP ---------- */
function showPopup(t,m){
  pTitle.innerText=t;
  pText.innerText=m;
  popup.style.display="flex";
}
function closePopup(){
  popup.style.display="none";
}
</script>

</body>
</html>
