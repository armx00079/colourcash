<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Account â€“ Colour Cash</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{margin:0;font-family:Arial;background:#f2f2f2;padding-bottom:90px}

.header{
  background:linear-gradient(135deg,#ff6a6a,#ff8e8e);
  padding:18px;color:#fff;display:flex;gap:12px
}
.header img{width:52px;height:52px;border-radius:50%}

.card{background:#fff;margin:15px;border-radius:16px;padding:18px}

.history{
  display:grid;grid-template-columns:1fr 1fr;gap:12px;margin:15px
}
.history div{
  background:linear-gradient(135deg,#ff9a9e,#fad0c4);
  padding:16px;border-radius:14px;font-weight:bold;text-align:center
}

.logout{
  background:#e53935;color:#fff;border:none;width:calc(100% - 30px);
  margin:15px;padding:14px;border-radius:14px;font-size:16px
}

/* BOTTOM NAV */
.bottom-nav{
  position:fixed;
  bottom:0;left:0;right:0;
  background:#111;
  display:flex;
  border-top:1px solid #222;
  z-index:99999;
}
.nav-btn{
  flex:1;
  text-align:center;
  padding:10px 0;
  font-size:12px;
  color:#aaa;
}
.nav-btn.active{
  color:#ff6a6a;
  font-weight:bold;
}
.nav-btn div{font-size:20px}
</style>
</head>

<body>

<div class="header">
  <img src="https://i.imgur.com/6VBx3io.png">
  <div>
    <h3 id="userName">USER</h3>
    <p>UID: <span id="uid"></span></p>
    <p>Last login: <span id="lastLogin"></span></p>
  </div>
</div>

<div class="card">
  <p>Total balance</p>
  <h2 id="accBalance">â‚¹0.00</h2>

  <div style="display:flex;justify-content:space-between;margin-top:15px">
    <div onclick="location.href='wallet.html'">ğŸ‘› Wallet</div>
    <div onclick="location.href='deposit.html'">ğŸ’° Deposit</div>
    <div onclick="location.href='withdraw.html'">ğŸ¦ Withdraw</div>
  </div>
</div>

<div class="history">
  <div onclick="location.href='deposit-history.html'">ğŸ“¥ My Deposit History</div>
  <div onclick="location.href='withdraw-history.html'">ğŸ“¤ My Withdraw History</div>
</div>

<button class="logout" onclick="logout()">Logout</button>

<div class="bottom-nav">
  <div class="nav-btn" onclick="location.href='index.html'">
    <div>ğŸ </div>Home
  </div>
  <div class="nav-btn" onclick="location.href='wallet.html'">
    <div>ğŸ’°</div>Wallet
  </div>
  <div class="nav-btn" onclick="location.href='promotion.html'">
    <div>ğŸ</div>Promotion
  </div>
  <div class="nav-btn active">
    <div>ğŸ‘¤</div>Account
  </div>
</div>

<!-- ğŸ”¥ ONLY SCRIPT FIXED -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore,
  collection,
  getDocs,
  query,
  where
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBx3J9aGn_98rTPgurMMKw_GR3puIMj4Ms",
  authDomain: "colourcash-ea60e.firebaseapp.com",
  projectId: "colourcash-ea60e"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* USER NAME */
const name = localStorage.getItem("userName") || "USER";
document.getElementById("userName").innerText = name.toUpperCase();

/* UID */
let uid = localStorage.getItem("uid");
if(!uid){
  uid = Math.floor(1000000 + Math.random()*9000000);
  localStorage.setItem("uid", uid);
}
document.getElementById("uid").innerText = uid;

/* LAST LOGIN */
document.getElementById("lastLogin").innerText =
  localStorage.getItem("lastLogin") || "-";

/* ğŸ”¥ LIVE BALANCE FROM FIRESTORE */
const userEmail = localStorage.getItem("userEmail");

async function loadBalance(){
  let balance = 0;

  const snap = await getDocs(
    query(collection(db,"users"), where("email","==",userEmail))
  );

  snap.forEach(d=>{
    balance = d.data().balance || 0;
  });

  document.getElementById("accBalance").innerText =
    "â‚¹" + balance.toFixed(2);
}

loadBalance();

function logout(){
  localStorage.clear();
  location.href="login.html";
}
</script>

</body>
</html>
