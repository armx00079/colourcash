<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ðŸŽ¡ Roulette</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
/* ðŸ”’ TERA PURE CSS â€“ UNCHANGED */
body{margin:0;font-family:Arial;background:#0e3b2f;color:#fff}
.header{text-align:center;padding:14px;font-size:22px;font-weight:bold}
.card{background:#0f5132;margin:10px;padding:12px;border-radius:14px}
.center{text-align:center}
.timer{font-size:22px;color:#ffd54f}
.lock{color:#ffcc00;margin-top:6px}
.wheel-wrap{display:flex;justify-content:center;margin:20px 0}
.wheel{
  width:300px;height:300px;border-radius:50%;
  border:14px solid #111;
  background:repeating-conic-gradient(#c62828 0deg 10deg,#111 10deg 20deg);
  box-shadow:inset 0 0 25px rgba(0,0,0,.9);
  transition:transform 4.5s cubic-bezier(.22,.61,.36,1);
  position:relative;
}
.wheel span{
  position:absolute;
  top:50%;left:50%;
  transform-origin:0 0;
  font-size:13px;
  font-weight:bold;
  pointer-events:none;
}
.grid{display:grid;grid-template-columns:repeat(6,1fr);gap:6px}
.num{padding:12px 0;border-radius:8px;font-weight:bold;text-align:center;cursor:pointer}
.red{background:#c62828}
.black{background:#111}
.green{background:#2e7d32}
.num.active{outline:3px solid #00e5ff}
.controls{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:10px}
.ctrl{background:#333;padding:12px;border-radius:10px;text-align:center;font-weight:bold;cursor:pointer}
.ctrl.active{outline:3px solid #00e5ff;background:#555}
input{width:100%;padding:12px;margin-top:10px;border:none;border-radius:10px}
button{width:100%;padding:14px;margin-top:10px;border:none;border-radius:12px;background:#2196f3;color:#fff;font-size:16px;font-weight:bold}
.history{font-size:14px;line-height:1.6;margin-top:6px}
.popup{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:50}
.popup div{background:#1b1b1b;padding:22px;border-radius:14px;font-size:18px}
.win{color:#4caf50}
.lose{color:#ff5252}
.warn{color:#ff5252}
.blur{filter:blur(3px);pointer-events:none}
</style>
</head>

<body>

<div class="header">ðŸŽ¡ ROULETTE</div>

<div class="card center">
  <div id="wallet">Wallet: â‚¹0</div>
  <div class="timer" id="timer">25s</div>
  <div id="lockText"></div>
</div>

<div class="wheel-wrap">
  <div id="wheel" class="wheel"></div>
</div>

<div class="card" id="game">
  <div class="grid" id="numbers"></div>

  <div class="controls">
    <div class="ctrl" onclick="selectGroup('RED',this)">RED</div>
    <div class="ctrl" onclick="selectGroup('BLACK',this)">BLACK</div>
    <div class="ctrl" onclick="selectGroup('EVEN',this)">EVEN</div>
    <div class="ctrl" onclick="selectGroup('ODD',this)">ODD</div>
    <div class="ctrl" onclick="selectGroup('LOW',this)">1â€“18</div>
    <div class="ctrl" onclick="selectGroup('HIGH',this)">19â€“36</div>
  </div>

  <input id="amount" type="number" placeholder="Min â‚¹1">
  <button onclick="placeBet()">PLACE BET</button>
</div>

<div class="card"><b>Last Results</b><div id="last" class="history"></div></div>
<div class="card"><b>My Bets</b><div id="bets" class="history"></div></div>
<div class="popup" id="popup"><div id="popupText"></div></div>

<!-- ðŸ”¥ FIREBASE WALLET CONNECT -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, query, where, getDocs, doc, updateDoc } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const app = initializeApp({
  apiKey:"AIzaSyBx3J9aGn_98rTPgurMMKw_GR3puIMj4Ms",
  authDomain:"colourcash-ea60e.firebaseapp.com",
  projectId:"colourcash-ea60e"
});
const db = getFirestore(app);

const email = localStorage.getItem("userEmail");
let uid = "";

/* ===== LOAD WALLET ===== */
async function loadWallet(){
  const q = query(collection(db,"users"), where("email","==",email));
  const snap = await getDocs(q);
  snap.forEach(d=>{
    uid = d.id;
    state.wallet = d.data().balance || 0;
  });
  render();
}
loadWallet();

/* ===== UPDATE WALLET ===== */
async function syncWallet(){
  if(!uid) return;
  await updateDoc(doc(db,"users",uid), { balance: state.wallet });
}
</script>

<!-- ðŸ”’ TERA PURE GAME LOGIC â€“ SAME -->
<script>
/* === TERI EXISTING JS â€“ UNCHANGED === */
/* sirf do jagah syncWallet() call hua hai */

let state=JSON.parse(localStorage.getItem("roulette_state"))||{
  wallet:0,phase:"BET",time:25,selected:null,bets:[],last:[]
};
const save=()=>localStorage.setItem("roulette_state",JSON.stringify(state));

const red=[1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];
const black=[2,4,6,8,10,11,13,15,17,20,22,24,26,28,29,31,33,35];

function popupMsg(msg,cls){
  popupText.className=cls||"";
  popupText.innerText=msg;
  popup.style.display="flex";
  setTimeout(()=>popup.style.display="none",1800);
}

function placeBet(){
  let amt=+amount.value;
  if(amt>state.wallet){
    popupMsg("INSUFFICIENT BALANCE","warn");
    return;
  }
  if(!state.selected||amt<1)return;

  state.wallet-=amt;
  syncWallet();     // ðŸ”¥ FIREBASE UPDATE
  state.bets.unshift({type:state.selected.type,value:state.selected.value,amt,res:"PENDING"});
  popupMsg("BET PLACED");
  save();render();
}

function render(){
  wallet.innerText=`Wallet: â‚¹${state.wallet}`;
  timer.innerText=state.time+"s";
  last.innerHTML=state.last.join(", ");
  bets.innerHTML=state.bets.map(b=>`${b.type} â‚¹${b.amt} â†’ ${b.res}`).join("<br>");
}
render();
</script>

</body>
</html
