<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ðŸŽ¡ Roulette</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{margin:0;font-family:Arial;background:#0e3b2f;color:#fff}
.header{text-align:center;padding:14px;font-size:22px;font-weight:bold}
.card{background:#0f5132;margin:10px;padding:12px;border-radius:14px}
.center{text-align:center}
.timer{font-size:22px;color:#ffd54f}
.lock{color:#ffcc00;margin-top:6px}

/* ===== WHEEL ===== */
.wheel-wrap{display:flex;justify-content:center;margin:20px 0}
.wheel{
  width:300px;height:300px;border-radius:50%;
  border:14px solid #111;
  background:repeating-conic-gradient(#c62828 0deg 10deg,#111 10deg 20deg);
  box-shadow:inset 0 0 25px rgba(0,0,0,.9);
  transition:transform 4.5s cubic-bezier(.22,.61,.36,1);
  position:relative;
}
.wheel span{
  position:absolute;
  top:50%;left:50%;
  transform-origin:0 0;
  font-size:13px;
  font-weight:bold;
}

/* ===== GRID ===== */
.grid{display:grid;grid-template-columns:repeat(6,1fr);gap:6px}
.num{padding:12px 0;border-radius:8px;font-weight:bold;text-align:center;cursor:pointer}
.red{background:#c62828}
.black{background:#111}
.green{background:#2e7d32}
.num.active{outline:3px solid #00e5ff}

/* ===== CONTROLS ===== */
.controls{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:10px}
.ctrl{
  background:#333;
  padding:12px;
  border-radius:10px;
  text-align:center;
  font-weight:bold;
  cursor:pointer;
}
.ctrl.active{
  outline:3px solid #00e5ff;
  background:#555;
}

input{width:100%;padding:12px;margin-top:10px;border:none;border-radius:10px}
button{width:100%;padding:14px;margin-top:10px;border:none;border-radius:12px;background:#2196f3;color:#fff;font-size:16px;font-weight:bold}
button:disabled{opacity:.5}

.history{font-size:14px;line-height:1.6;margin-top:6px}

/* POPUP */
.popup{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:50}
.popup div{background:#1b1b1b;padding:22px;border-radius:14px;font-size:18px}
.win{color:#4caf50}
.lose{color:#ff5252}
.warn{color:#ff5252}

.blur{filter:blur(3px);pointer-events:none}
</style>
</head>

<body>

<div class="header">ðŸŽ¡ ROULETTE</div>

<div class="card center">
  <div id="wallet">Wallet: â‚¹0</div>
  <div class="timer" id="timer">25s</div>
  <div id="lockText"></div>
</div>

<div class="wheel-wrap">
  <div id="wheel" class="wheel"></div>
</div>

<div class="card" id="game">
  <div class="grid" id="numbers"></div>

  <div class="controls" id="groupBtns">
    <div class="ctrl" data-type="RED">RED</div>
    <div class="ctrl" data-type="BLACK">BLACK</div>
    <div class="ctrl" data-type="EVEN">EVEN</div>
    <div class="ctrl" data-type="ODD">ODD</div>
    <div class="ctrl" data-type="LOW">1â€“18</div>
    <div class="ctrl" data-type="HIGH">19â€“36</div>
  </div>

  <input id="amount" type="number" placeholder="Min â‚¹1">
  <button id="betBtn">PLACE BET</button>
</div>

<div class="card">
  <b>Last Results</b>
  <div class="history" id="last"></div>
</div>

<div class="card">
  <b>My Bets</b>
  <div class="history" id="bets"></div>
</div>

<div class="popup" id="popup"><div id="popupText"></div></div>

<script type="module">
/* ðŸ”¥ FIREBASE */
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, query, where, getDocs, doc, updateDoc }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig={
  apiKey:"YOUR_KEY",
  authDomain:"YOUR_DOMAIN",
  projectId:"YOUR_PROJECT"
};
const app=initializeApp(firebaseConfig);
const db=getFirestore(app);

/* USER */
const email=localStorage.getItem("userEmail");
let uid="";

/* STATE */
let state={
  wallet:0,
  selected:null,
  bets:[],
  last:[],
  phase:"BET",
  time:25
};

/* COLORS */
const red=[1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];
const black=[2,4,6,8,10,11,13,15,17,20,22,24,26,28,29,31,33,35];

/* LOAD WALLET */
async function loadWallet(){
  const q=query(collection(db,"users"),where("email","==",email));
  const s=await getDocs(q);
  s.forEach(d=>{
    uid=d.id;
    state.wallet=d.data().balance||0;
  });
  render();
}

/* SYNC WALLET */
function syncWallet(){
  if(uid) updateDoc(doc(db,"users",uid),{balance:state.wallet});
}

/* GRID */
const grid=document.getElementById("numbers");
for(let i=0;i<=36;i++){
  let d=document.createElement("div");
  d.className="num "+(i===0?"green":red.includes(i)?"red":"black");
  d.innerText=i;
  d.onclick=()=>selectNumber(i,d);
  grid.appendChild(d);
}

/* CLEAR */
function clearAll(){
  document.querySelectorAll(".num").forEach(x=>x.classList.remove("active"));
  document.querySelectorAll(".ctrl").forEach(x=>x.classList.remove("active"));
}

/* NUMBER SELECT */
function selectNumber(n,el){
  if(state.phase!=="BET")return;
  clearAll();
  el.classList.add("active");
  state.selected={type:"NUMBER",value:n};
}

/* GROUP SELECT (ðŸ”¥ FIXED) */
document.querySelectorAll(".ctrl").forEach(btn=>{
  btn.onclick=()=>{
    if(state.phase!=="BET")return;
    clearAll();
    btn.classList.add("active");
    state.selected={type:btn.dataset.type};
  };
});

/* POPUP */
function popup(msg,cls){
  popupText.className=cls||"";
  popupText.innerText=msg;
  popup.style.display="flex";
  setTimeout(()=>popup.style.display="none",1600);
}

/* BET */
betBtn.onclick=()=>{
  let amt=+amount.value;
  if(!state.selected||amt<1)return;
  if(amt>state.wallet){
    popup("INSUFFICIENT BALANCE","warn");
    return;
  }
  state.wallet-=amt;
  syncWallet();
  state.bets.unshift({type:state.selected.type,value:state.selected.value,amt,res:"PENDING"});
  popup("BET PLACED");
  render();
};

/* RENDER */
function render(){
  wallet.innerText=`Wallet: â‚¹${state.wallet}`;
  timer.innerText=state.time+"s";
  last.innerHTML=state.last.join(", ");
  bets.innerHTML=state.bets.map(b=>`${b.type} â‚¹${b.amt} â†’ ${b.res}`).join("<br>");
}

/* INIT */
loadWallet();
render();
</script>

</body>
</html>
