<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>WIN GO</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<style>
/* ‚ö†Ô∏è ORIGINAL CSS ‚Äì NOT TOUCHED */
body{margin:0;font-family:Arial;background:#0f0f0f;color:#fff}
.header{text-align:center;padding:15px;font-size:22px}
.top{display:flex;justify-content:space-between;padding:0 15px;color:#bbb}
.timer{text-align:center;font-size:34px;color:#ff4081;margin:10px}
.card{background:#1c1c1c;margin:15px;padding:15px;border-radius:12px}
input{width:100%;padding:12px;font-size:18px;border-radius:8px;border:none;text-align:center}
.grid3,.grid5{display:grid;gap:8px;margin-top:10px}
.grid3{grid-template-columns:repeat(3,1fr)}
.grid5{grid-template-columns:repeat(5,1fr)}
.btn{padding:14px;border:none;border-radius:10px;font-weight:bold;color:#fff}
.red{background:#e53935}
.green{background:#43a047}
.violet{background:#8e24aa}
.dark{background:#333}
.bigsmall{display:flex;margin-top:10px}
.bigsmall button{flex:1;padding:12px;border:none;font-size:16px}
.big{background:#f4a261}
.small{background:#4dabf7}
.lock{pointer-events:none;opacity:.4}
</style>
</head>

<body>

<div class="header">üé® WIN GO</div>

<div class="top">
  <div>Period: <span id="period">----</span></div>
  <div>Wallet: ‚Çπ<span id="wallet">0</span></div>
</div>

<div class="timer">‚è≥ <span id="time">--</span>s</div>

<div class="card" id="betBox">
  <input id="amount" type="number" placeholder="Min ‚Çπ1">

  <div class="grid3">
    <button class="btn red" onclick="bet('color','RED')">RED</button>
    <button class="btn green" onclick="bet('color','GREEN')">GREEN</button>
    <button class="btn violet" onclick="bet('color','VIOLET')">VIOLET</button>
  </div>

  <div class="grid5">
    <button class="btn dark" onclick="bet('number',0)">0</button>
    <button class="btn dark" onclick="bet('number',1)">1</button>
    <button class="btn dark" onclick="bet('number',2)">2</button>
    <button class="btn dark" onclick="bet('number',3)">3</button>
    <button class="btn dark" onclick="bet('number',4)">4</button>
    <button class="btn dark" onclick="bet('number',5)">5</button>
    <button class="btn dark" onclick="bet('number',6)">6</button>
    <button class="btn dark" onclick="bet('number',7)">7</button>
    <button class="btn dark" onclick="bet('number',8)">8</button>
    <button class="btn dark" onclick="bet('number',9)">9</button>
  </div>

  <div class="bigsmall">
    <button class="big" onclick="bet('bs','BIG')">Big</button>
    <button class="small" onclick="bet('bs','SMALL')">Small</button>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, onSnapshot, updateDoc } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const app = initializeApp({
  apiKey:"AIzaSyBx3J9aGn_98rTPgurMMKw_GR3puIMj4Ms",
  authDomain:"colourcash-ea60e.firebaseapp.com",
  projectId:"colourcash-ea60e"
});
const db = getFirestore(app);

const periodEl = document.getElementById("period");
const timeEl = document.getElementById("time");
const betBox = document.getElementById("betBox");
const walletEl = document.getElementById("wallet");

let betEnd = 0;
let status = "BET";
let wallet = 1000; // demo wallet

walletEl.innerText = wallet;

/* üî• LISTEN GLOBAL ROUND */
onSnapshot(doc(db,"wingo_round","current"), snap=>{
  if(!snap.exists()) return;
  const d = snap.data();

  periodEl.innerText = d.period;
  betEnd = d.betEnd;
  status = d.status;

  if(status==="BET"){
    betBox.classList.remove("lock");
  }else{
    betBox.classList.add("lock");
  }
});

/* ‚è≥ TIMER FIX */
setInterval(()=>{
  if(!betEnd) return;
  const now = Math.floor(Date.now()/1000);
  let t = betEnd - now;
  if(t < 0) t = 0;
  timeEl.innerText = t;
},1000);

/* üéØ BET FUNCTION */
window.bet = (type,val)=>{
  if(status!=="BET") return alert("Bet Locked");
  let amt = Number(amount.value||0);
  if(amt < 1) return alert("Min ‚Çπ1");
  if(amt > wallet) return alert("Low Balance");

  wallet -= amt;
  walletEl.innerText = wallet;

  alert("BET PLACED ‚Üí " + type + " : " + val);
};
</script>

</body>
</html>
